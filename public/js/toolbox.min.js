var iflicks=function(){function a(b,c){void 0===c&&(c=10),void 0!==b&&console.log((new Date).toUTCString()+" :: "+b);var d,e,f,g,h=9e13,i={};for(b&&(c=Date.now()+1e3*c,i.message=b,i.timeout=c,p.push(i)),e=document.getElementById("message");e.hasChildNodes();)e.removeChild(e.firstChild);d=document.createDocumentFragment(),p.forEach(function(a,b){a.timeout<=Date.now()?p.splice(b,1):(f=document.createTextNode(a.message),g=document.createElement("br"),d.appendChild(f),d.appendChild(g),a.timeout<h&&(h=a.timeout))}),e.appendChild(d),9e13>h&&(c=h-Date.now(),setTimeout(function(){a()},c))}function b(a){return(document.cookie.match("(^|; )"+a+"=([^;]*)")||0)[2]}function c(a,b,c){var d,e;c?(e=new Date,e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()):d="",document.cookie=a+"="+b+d+"; path=/"}function d(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;for(l=document.getElementById(d),m=l.getElementsByTagName("tbody")[0],e=m.getElementsByTagName("tr").length-1;e>-1;e--){for(i=m.rows[e],k=!1,f=a.length-1;f>-1;f--)if(a[f].id===i.id||a[f]._id===i.id){c?a.update=!0:a.splice(f,1),k=!0;break}k===!1&&m.removeChild(i)}if(c)for(e=m.getElementsByTagName("tr").length-1;e>-1;e--)for(i=m.rows[e],f=0;f<a.length;f++)if(a[f].id===i.id||a[f]._id===i.id){for(i.title!==JSON.stringify(a[f])&&(i.title=JSON.stringify(a[f])),g=0;g<i.cells.length;g++)if("text"===b[g].type){k=!1;for(h in a[f])(a[f].id+h===i.cells[g].id||a[f]._id+h===i.cells[g].id)&&(k=!0,a[f][h].toString()!==i.cells[g].textContent&&(i.cells[g].textContent=a[f][h]));k||(i.cells[g].textContent="")}a.splice(f,1)}var p,q;a.forEach(function(a){for(i=m.insertRow(0),i.id=a.id||a._id,i.title=JSON.stringify(a),e=0;e<b.length;e++)q=b[e],n=void 0===a[q.name]?"":a[q.name],j=i.insertCell(-1),j.id=i.id+q.name,"text"===q.type?p=document.createTextNode(n):"inputText"===q.type?(p=document.createElement("input"),p.type="text",p.name=q.name,p.value=n,p.className="formInput"):"inputCheckbox"===q.type?(p=document.createElement("input"),p.type="checkbox",p.name=q.name,p.checked=n,p.className="formInput"):"inputSave"===q.type?(p=document.createElement("input"),p.type="button",p.name=q.name,p.value=q.value,q.handler&&!function(a,b){p.addEventListener("click",function(c){o[a](c,b)})}(q.handler,i.id)):p=document.createTextNode("ERROR :: "+n),j.appendChild(p)}),l.classList.remove("hide")}function e(a,b){var c,d,e,f,g,h;for(d=document.getElementById(b),e=d.getElementsByTagName("thead")[0],e.classList.add("tableHead");e.firstChild;)e.removeChild(e.firstChild);for(f=e.insertRow(0),c=0;c<a.length;c++)g=f.insertCell(-1),h=document.createTextNode(a[c].value),g.appendChild(h)}function f(a,b){window.fetch(a,{credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(a){return a.json()}).then(b)["catch"](function(a){console.log(a.message),"Failed to fetch"===a.message&&document.location.reload(!1)})}function g(a){a.preventDefault();var b=document.getElementById("extras"),c=a.target.id,g=document.getElementById("search").value,h=document.getElementById("limit").value;for((void 0===g||0===g.length)&&(g="-");b.firstChild;)b.removeChild(b.firstChild);f("/toolbox/"+c+"col",function(a){e(a,"list"),f("/toolbox/"+c+"/"+h+"/"+g,function(b){d(b,a,!0,"list"),clearInterval(n),n=setInterval(function(){f("/toolbox/"+c+"/"+h+"/"+g,function(b){d(b,a,!0,"list")})},5e3)})})}function h(){function a(a){var b,c,d,e,f=document.getElementById("extras"),g=document.createElement("span");for(b=0;b<a.length;b++)c=a[b],"inputText"===c.type?(d=document.createElement("input"),d.type="text",d.name=c.name,d.placeholder=c.value):"inputCheckbox"===c.type&&(d=document.createElement("input"),d.type="checkbox",d.name=c.name),g.appendChild(d);for(e=document.createElement("input"),e.type="button",e.value="Add",e.addEventListener("click",o.addUser),g.appendChild(e);f.firstChild;)f.removeChild(f.firstChild);f.appendChild(g)}var b=document.getElementById("search").value,c=document.getElementById("limit").value;(void 0===b||0===b.length)&&(b="-"),f("/toolbox/userviewercol",function(g){e(g,"list"),a(g),f("/toolbox/userviewer/"+c+"/"+b,function(a){d(a,g,!0,"list"),clearInterval(n),n=setInterval(function(){f("/toolbox/userviewer/"+c+"/"+b,function(a){d(a,g,!0,"list")})},3e4)})})}function i(a){a.preventDefault(),h()}function j(){clearInterval(n),e([],"list"),d([],[],!1,"list")}function k(){"true"===b("cookeiConsent")&&(document.getElementById("cookieBanner").className="hide")}function l(){document.getElementById("cookieBanner").className="hide",c("cookeiConsent","true",1)}function m(){var a,b,c=document.getElementsByClassName("viewers");for(a=0;a<c.length;a++)c[a].addEventListener("click",g);document.getElementById("userviewer").addEventListener("click",i),document.getElementById("limit").addEventListener("change",j),b=document.getElementById("submitCookieAccept"),b&&b.addEventListener("click",l),k()}var n,o={},p=[];o.deleteUser=function(b,c){var d=window.confirm("Are you sure you want to delete?");d===!0&&window.fetch("/toolbox/user",{credentials:"include",method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userId:c})}).then(function(a){return a.json()}).then(function(c){b.target.parentNode.parentNode.parentNode.removeChild(b.target.parentNode.parentNode),c.error?a(c.error,6):c.reply?a(c.reply,6):a("Unexpected response",10)})["catch"](function(b){a(b.message,10)})},o.addUser=function(b){var c,d,e={};for(c=0;c<b.target.parentNode.childNodes.length;c++)d=b.target.parentNode.childNodes[c],"text"===d.type?e[d.name]=d.value:"checkbox"===d.type&&(e[d.name]=d.checked);window.fetch("/toolbox/user",{credentials:"include",method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(a){return a.json()}).then(function(b){b.error?a(b.error,6):b.reply?(a(b.reply,6),h()):a("Unexpected response",10)})["catch"](function(b){a(b.message,10)})},o.amendUser=function(b,c){var d,e,f={userId:c};for(d=0;d<b.target.parentNode.parentNode.childNodes.length;d++)e=b.target.parentNode.parentNode.childNodes[d].firstChild,"text"===e.type?e.value&&(f[e.name]=e.value):"checkbox"===e.type&&(f[e.name]=e.checked);window.fetch("/toolbox/user",{credentials:"include",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(f)}).then(function(a){return a.json()}).then(function(b){b.error?a(b.error,6):b.reply?a(b.reply,6):a("Unexpected response",10)})["catch"](function(b){a(b.message,10)})},m()}();